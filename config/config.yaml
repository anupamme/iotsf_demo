project:
  name: "IoT Security Demo"
  version: "1.0.0"

data:
  raw_dir: "data/raw"
  processed_dir: "data/processed"
  synthetic_dir: "data/synthetic"
  ciciot_subset_size: 10000  # Samples per class

models:
  diffusion_ts:
    seq_length: 128
    feature_dim: 12
    n_diffusion_steps: 1000
    checkpoint: "models/diffusion_ts.pt"
  moirai:
    model_size: "small"  # small, base, large
    context_length: 512
    prediction_length: 64
    patch_size: 32
    confidence_level: 0.95  # Confidence level for intervals
    anomaly_threshold: 0.95  # Detection threshold
    checkpoint: null  # Optional fine-tuned checkpoint path
  baseline:
    method: "threshold"  # threshold, isolation_forest, lstm

demo:
  n_benign_samples: 3
  n_attack_samples: 3
  attack_types:
    - "slow_exfiltration"
    - "lotl_mimicry"
    - "protocol_anomaly"

device:
  use_gpu: true
  gpu_id: 0

visualization:
  theme: "plotly_dark"
  colors:
    benign: "#00CC96"
    attack: "#EF553B"
    detected: "#636EFA"

constraints:
  enabled: true
  default_protocol: "modbus"
  strictness: "moderate"  # strict, moderate, permissive

  protocols:
    modbus:
      enabled: true
      packet_size_range: [7, 260]
      valid_function_codes: [1, 2, 3, 4, 5, 6, 15, 16, 20, 21, 22, 23, 24, 43]
      timing_min_ms: 1
      timing_max_ms: 1000
      soft_constraints:
        packet_size_mean: 64
        packet_size_std: 32
        inter_arrival_lambda: 0.1

    mqtt:
      enabled: true
      packet_size_range: [2, 1024]
      valid_message_types: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
      qos_levels: [0, 1, 2]
      keep_alive_range: [60, 300]
      soft_constraints:
        packet_size_mean: 128
        packet_size_std: 256
        keep_alive_mean: 180

    coap:
      enabled: true
      packet_size_range: [4, 1280]
      token_length_range: [0, 8]
      valid_message_types: [0, 1, 2, 3]
      valid_methods: [1, 2, 3, 4]
      soft_constraints:
        packet_size_mean: 128
        packet_size_std: 96
        request_interval_mean: 5.0
